{
  explainVersion: '1',
  stages: [
    {
      '$cursor': {
        queryPlanner: {
          namespace: 'spotify.tracks',
          parsedQuery: {
            '$and': [
              {
                decade: {
                  '$not': {
                    '$eq': null
                  }
                }
              },
              {
                popularity: {
                  '$not': {
                    '$eq': null
                  }
                }
              }
            ]
          },
          indexFilterSet: false,
          queryHash: '28926EFE',
          planCacheShapeHash: '28926EFE',
          planCacheKey: '3B6BA0CB',
          optimizationTimeMillis: 0,
          maxIndexedOrSolutionsReached: false,
          maxIndexedAndSolutionsReached: false,
          maxScansToExplodeReached: false,
          prunedSimilarIndexes: false,
          winningPlan: {
            isCached: false,
            stage: 'PROJECTION_SIMPLE',
            transformBy: {
              decade: 1,
              energy: 1,
              popularity: 1,
              valence: 1,
              _id: 0
            },
            inputStage: {
              stage: 'FETCH',
              inputStage: {
                stage: 'IXSCAN',
                keyPattern: {
                  decade: 1,
                  popularity: -1
                },
                indexName: 'decade_1_popularity_-1',
                isMultiKey: false,
                multiKeyPaths: {
                  decade: [],
                  popularity: []
                },
                isUnique: false,
                isSparse: false,
                isPartial: false,
                indexVersion: 2,
                direction: 'forward',
                indexBounds: {
                  decade: [
                    '[MinKey, null)',
                    '(null, MaxKey]'
                  ],
                  popularity: [
                    '[MaxKey, null)',
                    '(null, MinKey]'
                  ]
                }
              }
            }
          },
          rejectedPlans: []
        },
        executionStats: {
          executionSuccess: true,
          nReturned: 448081,
          executionTimeMillis: 1032,
          totalKeysExamined: 448082,
          totalDocsExamined: 448081,
          executionStages: {
            isCached: false,
            stage: 'PROJECTION_SIMPLE',
            nReturned: 448081,
            executionTimeMillisEstimate: 148,
            works: 448083,
            advanced: 448081,
            needTime: 1,
            needYield: 0,
            saveState: 58,
            restoreState: 58,
            isEOF: 1,
            transformBy: {
              decade: 1,
              energy: 1,
              popularity: 1,
              valence: 1,
              _id: 0
            },
            inputStage: {
              stage: 'FETCH',
              nReturned: 448081,
              executionTimeMillisEstimate: 108,
              works: 448083,
              advanced: 448081,
              needTime: 1,
              needYield: 0,
              saveState: 58,
              restoreState: 58,
              isEOF: 1,
              docsExamined: 448081,
              alreadyHasObj: 0,
              inputStage: {
                stage: 'IXSCAN',
                nReturned: 448081,
                executionTimeMillisEstimate: 44,
                works: 448083,
                advanced: 448081,
                needTime: 1,
                needYield: 0,
                saveState: 58,
                restoreState: 58,
                isEOF: 1,
                keyPattern: {
                  decade: 1,
                  popularity: -1
                },
                indexName: 'decade_1_popularity_-1',
                isMultiKey: false,
                multiKeyPaths: {
                  decade: [],
                  popularity: []
                },
                isUnique: false,
                isSparse: false,
                isPartial: false,
                indexVersion: 2,
                direction: 'forward',
                indexBounds: {
                  decade: [
                    '[MinKey, null)',
                    '(null, MaxKey]'
                  ],
                  popularity: [
                    '[MaxKey, null)',
                    '(null, MinKey]'
                  ]
                },
                keysExamined: 448082,
                seeks: 2,
                dupsTested: 0,
                dupsDropped: 0
              }
            }
          }
        }
      },
      nReturned: 448081,
      executionTimeMillisEstimate: 567
    },
    {
      '$set': {
        _p10: {
          '$multiply': [
            {
              '$floor': [
                {
                  '$divide': [
                    '$popularity',
                    {
                      '$const': 10
                    }
                  ]
                }
              ]
            },
            {
              '$const': 10
            }
          ]
        },
        energy_d: {
          '$convert': {
            input: '$energy',
            to: {
              '$const': 'double'
            }
          }
        },
        valence_d: '$valence'
      },
      nReturned: 448081,
      executionTimeMillisEstimate: 683
    },
    {
      '$set': {
        pop_bucket: {
          '$concat': [
            {
              '$convert': {
                input: '$_p10',
                to: {
                  '$const': 'string'
                },
                format: {
                  '$const': 'auto'
                }
              }
            },
            {
              '$const': '-'
            },
            {
              '$convert': {
                input: {
                  '$add': [
                    '$_p10',
                    {
                      '$const': 9
                    }
                  ]
                },
                to: {
                  '$const': 'string'
                },
                format: {
                  '$const': 'auto'
                }
              }
            }
          ]
        }
      },
      nReturned: 448081,
      executionTimeMillisEstimate: 869
    },
    {
      '$group': {
        _id: {
          decade: '$decade',
          pop_bucket: '$pop_bucket'
        },
        track_count: {
          '$sum': {
            '$const': 1
          }
        },
        avg_energy: {
          '$avg': '$energy_d'
        },
        avg_valence: {
          '$avg': '$valence_d'
        }
      },
      maxAccumulatorMemoryUsageBytes: {
        track_count: 12104,
        avg_energy: 9256,
        avg_valence: 9256
      },
      totalOutputDataSizeBytes: 49306,
      usedDisk: false,
      spills: 0,
      spilledDataStorageSize: 0,
      numBytesSpilledEstimate: 0,
      spilledRecords: 0,
      nReturned: 89,
      executionTimeMillisEstimate: 1021
    },
    {
      '$sort': {
        sortKey: {
          '_id.decade': 1,
          '_id.pop_bucket': 1
        }
      },
      totalDataSizeSortedBytesEstimate: 56426,
      usedDisk: false,
      spills: 0,
      spilledDataStorageSize: 0,
      nReturned: 89,
      executionTimeMillisEstimate: 1021
    }
  ],
  queryShapeHash: 'DB4622A59863CA48D043262D4CD0ED4DBC580AA56D035B6AC992DD583D3251BA',
  serverInfo: {
    host: 'Mac.fritz.box',
    port: 27017,
    version: '8.0.12',
    gitVersion: 'b60fc6875b5fb4b63cc0dbbd8dda0d6d6277921a'
  },
  serverParameters: {
    internalQueryFacetBufferSizeBytes: 104857600,
    internalQueryFacetMaxOutputDocSizeBytes: 104857600,
    internalLookupStageIntermediateDocumentMaxSizeBytes: 104857600,
    internalDocumentSourceGroupMaxMemoryBytes: 104857600,
    internalQueryMaxBlockingSortMemoryUsageBytes: 104857600,
    internalQueryProhibitBlockingMergeOnMongoS: 0,
    internalQueryMaxAddToSetBytes: 104857600,
    internalDocumentSourceSetWindowFieldsMaxMemoryBytes: 104857600,
    internalQueryFrameworkControl: 'trySbeRestricted',
    internalQueryPlannerIgnoreIndexWithCollationForRegex: 1
  },
  command: {
    aggregate: 'tracks',
    pipeline: [
      {
        '$match': {
          decade: {
            '$ne': null
          },
          popularity: {
            '$ne': null
          }
        }
      },
      {
        '$sort': {
          decade: 1,
          popularity: -1
        }
      },
      {
        '$set': {
          _p10: {
            '$multiply': [
              {
                '$floor': {
                  '$divide': [
                    '$popularity',
                    10
                  ]
                }
              },
              10
            ]
          },
          energy_d: {
            '$toDouble': '$energy'
          },
          valence_d: '$valence'
        }
      },
      {
        '$set': {
          pop_bucket: {
            '$concat': [
              {
                '$toString': '$_p10'
              },
              '-',
              {
                '$toString': {
                  '$add': [
                    '$_p10',
                    9
                  ]
                }
              }
            ]
          }
        }
      },
      {
        '$group': {
          _id: {
            decade: '$decade',
            pop_bucket: '$pop_bucket'
          },
          track_count: {
            '$sum': 1
          },
          avg_energy: {
            '$avg': '$energy_d'
          },
          avg_valence: {
            '$avg': '$valence_d'
          }
        }
      },
      {
        '$sort': {
          '_id.decade': 1,
          '_id.pop_bucket': 1
        }
      }
    ],
    allowDiskUse: true,
    hint: 'decade_1_popularity_-1',
    cursor: {},
    '$db': 'spotify'
  },
  ok: 1
}