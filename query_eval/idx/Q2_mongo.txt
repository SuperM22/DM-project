{
  explainVersion: '1',
  stages: [
    {
      '$cursor': {
        queryPlanner: {
          namespace: 'spotify.tracks',
          parsedQuery: {},
          indexFilterSet: false,
          queryHash: 'AB137F8A',
          planCacheShapeHash: 'AB137F8A',
          planCacheKey: '0A6AAB62',
          optimizationTimeMillis: 0,
          maxIndexedOrSolutionsReached: false,
          maxIndexedAndSolutionsReached: false,
          maxScansToExplodeReached: false,
          prunedSimilarIndexes: false,
          winningPlan: {
            isCached: false,
            stage: 'PROJECTION_DEFAULT',
            transformBy: {
              _id: true,
              id_artists: true,
              popularity: {
                '$convert': {
                  input: '$popularity',
                  to: {
                    '$const': 'double'
                  },
                  onError: {
                    '$const': null
                  },
                  onNull: {
                    '$const': null
                  }
                }
              }
            },
            inputStage: {
              stage: 'FETCH',
              inputStage: {
                stage: 'IXSCAN',
                keyPattern: {
                  id_artists: 1
                },
                indexName: 'id_artists_1',
                isMultiKey: false,
                multiKeyPaths: {
                  id_artists: []
                },
                isUnique: false,
                isSparse: false,
                isPartial: false,
                indexVersion: 2,
                direction: 'forward',
                indexBounds: {
                  id_artists: [
                    '[MinKey, MaxKey]'
                  ]
                }
              }
            }
          },
          rejectedPlans: []
        },
        executionStats: {
          executionSuccess: true,
          nReturned: 586672,
          executionTimeMillis: 1187,
          totalKeysExamined: 586672,
          totalDocsExamined: 586672,
          executionStages: {
            isCached: false,
            stage: 'PROJECTION_DEFAULT',
            nReturned: 586672,
            executionTimeMillisEstimate: 233,
            works: 586673,
            advanced: 586672,
            needTime: 0,
            needYield: 0,
            saveState: 105,
            restoreState: 105,
            isEOF: 1,
            transformBy: {
              _id: true,
              id_artists: true,
              popularity: {
                '$convert': {
                  input: '$popularity',
                  to: {
                    '$const': 'double'
                  },
                  onError: {
                    '$const': null
                  },
                  onNull: {
                    '$const': null
                  }
                }
              }
            },
            inputStage: {
              stage: 'FETCH',
              nReturned: 586672,
              executionTimeMillisEstimate: 125,
              works: 586673,
              advanced: 586672,
              needTime: 0,
              needYield: 0,
              saveState: 105,
              restoreState: 105,
              isEOF: 1,
              docsExamined: 586672,
              alreadyHasObj: 0,
              inputStage: {
                stage: 'IXSCAN',
                nReturned: 586672,
                executionTimeMillisEstimate: 20,
                works: 586673,
                advanced: 586672,
                needTime: 0,
                needYield: 0,
                saveState: 105,
                restoreState: 105,
                isEOF: 1,
                keyPattern: {
                  id_artists: 1
                },
                indexName: 'id_artists_1',
                isMultiKey: false,
                multiKeyPaths: {
                  id_artists: []
                },
                isUnique: false,
                isSparse: false,
                isPartial: false,
                indexVersion: 2,
                direction: 'forward',
                indexBounds: {
                  id_artists: [
                    '[MinKey, MaxKey]'
                  ]
                },
                keysExamined: 586672,
                seeks: 1,
                dupsTested: 0,
                dupsDropped: 0
              }
            }
          }
        }
      },
      nReturned: 586672,
      executionTimeMillisEstimate: 891
    },
    {
      '$match': {
        popularity: {
          '$not': {
            '$eq': null
          }
        }
      },
      nReturned: 586672,
      executionTimeMillisEstimate: 982
    },
    {
      '$unwind': {
        path: '$id_artists'
      },
      nReturned: 586672,
      executionTimeMillisEstimate: 999
    },
    {
      '$group': {
        _id: '$id_artists',
        avg_popularity: {
          '$avg': '$popularity'
        },
        max_popularity: {
          '$max': '$popularity'
        },
        tracks: {
          '$sum': {
            '$const': 1
          }
        }
      },
      maxAccumulatorMemoryUsageBytes: {
        avg_popularity: 11966448,
        max_popularity: 8284464,
        tracks: 15648432
      },
      totalOutputDataSizeBytes: 43705628,
      usedDisk: false,
      spills: 0,
      spilledDataStorageSize: 0,
      numBytesSpilledEstimate: 0,
      spilledRecords: 0,
      nReturned: 115062,
      executionTimeMillisEstimate: 1118
    },
    {
      '$sort': {
        sortKey: {
          avg_popularity: -1
        }
      },
      totalDataSizeSortedBytesEstimate: 44626124,
      usedDisk: false,
      spills: 0,
      spilledDataStorageSize: 0,
      nReturned: 115062,
      executionTimeMillisEstimate: 1118
    }
  ],
  queryShapeHash: 'BE2AC4A9E844175B34B5C5B8EAA42A3C23E6E96D72A9C2E07A14F9397F8D32AD',
  serverInfo: {
    host: 'Mac.fritz.box',
    port: 27017,
    version: '8.0.12',
    gitVersion: 'b60fc6875b5fb4b63cc0dbbd8dda0d6d6277921a'
  },
  serverParameters: {
    internalQueryFacetBufferSizeBytes: 104857600,
    internalQueryFacetMaxOutputDocSizeBytes: 104857600,
    internalLookupStageIntermediateDocumentMaxSizeBytes: 104857600,
    internalDocumentSourceGroupMaxMemoryBytes: 104857600,
    internalQueryMaxBlockingSortMemoryUsageBytes: 104857600,
    internalQueryProhibitBlockingMergeOnMongoS: 0,
    internalQueryMaxAddToSetBytes: 104857600,
    internalDocumentSourceSetWindowFieldsMaxMemoryBytes: 104857600,
    internalQueryFrameworkControl: 'trySbeRestricted',
    internalQueryPlannerIgnoreIndexWithCollationForRegex: 1
  },
  command: {
    aggregate: 'tracks',
    pipeline: [
      {
        '$project': {
          id_artists: 1,
          popularity: {
            '$convert': {
              input: '$popularity',
              to: 'double',
              onError: null,
              onNull: null
            }
          }
        }
      },
      {
        '$match': {
          popularity: {
            '$ne': null
          }
        }
      },
      {
        '$unwind': '$id_artists'
      },
      {
        '$group': {
          _id: '$id_artists',
          avg_popularity: {
            '$avg': '$popularity'
          },
          max_popularity: {
            '$max': '$popularity'
          },
          tracks: {
            '$sum': 1
          }
        }
      },
      {
        '$sort': {
          avg_popularity: -1
        }
      }
    ],
    allowDiskUse: true,
    hint: 'id_artists_1',
    cursor: {},
    '$db': 'spotify'
  },
  ok: 1
}